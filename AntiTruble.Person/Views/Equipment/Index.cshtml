
@{
    ViewData["Title"] = "Менеджер устройств";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using AntiTruble.ClassLibrary.Models;
@model IEnumerable<EquipmentInfo>

<div id="add-equipment"></div>

<div id="equipment-list">
    <h2>Устройства в ремонте:</h2>
    <hr />
    <div style="float: right; margin-bottom:10px;">
        <button style="width: 200px; height: 30px;" class="btn-default" id="addEquipment" onclick="onClickAddEquipment()">Добавить оборудование</button>
    </div>
    <table class="table table-bordered table-responsive table-hover">
        <tr>
            <th>Номер оборудования</th>
            <th>Название</th>
            <th>Тип</th>
            <th>Дефекты</th>
        </tr>
        @foreach (var equipment in Model)
        {
            <tr>
                <td>@equipment.EquipmentId</td>
                <td>@equipment.Name</td>
                <td>@equipment.EquipmentType.ToString()</td>
                <td>
                    <ul>
                        @foreach (var defect in equipment.Defects)
                        {
                            <li>
                                @defect.DefectName  —  @defect.Price.Value.ToString() руб.
                            </li>
                        }
                    </ul>
                </td>
            </tr>
        }
    </table>
</div>

<script type="text/javascript">

    $(document).ready(function () {
        $('#equipment-list').show();
    });

    function onClickAddEquipment() {
        $('#equipment-list').hide();
        
          var urlPath = '@Url.Action("GetAddPartial", "Equipment")';
          $.ajax({
            type: "GET",
            url: urlPath,
            dataType: "html",
              success: function (data) {
                  debugger;
                $("#add-equipment").html(data);
                },
                error: function () {
                    alert("error");
                }
            });
    }

</script>